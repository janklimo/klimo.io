<!DOCTYPE html>
<html lang="en"  prefix="og: http://ogp.me/ns#">
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico" />
<link rel="icon" type="image/png" href="/images/touch-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-180x180.png" sizes="180x180" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-167x167.png" sizes="167x167" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-152x152.png" sizes="152x152" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-144x144.png" sizes="144x144" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-120x120.png" sizes="120x120" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-114x114.png" sizes="114x114" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-76x76.png" sizes="76x76" />
<link rel="apple-touch-icon-precomposed" type="image/png" href="/images/apple-touch-icon-72x72.png" sizes="72x72" />
<link rel="apple-touch-icon-precomposed" type="image/x-icon" href="/images/apple-touch-icon-precomposed.png" />
<link rel="apple-touch-startup-image" type="image/x-icon" href="/images/apple-touch-startup-image.png" />
<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico" />
  <title>Seeding Images From Unsplash &middot; A blog by Jan Klimo</title>
  <meta name="description" content="Get beautiful images seed data with zero effort.">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="generator" content="Hugo 0.55.6" />
  <meta name="robots" content="index,follow">
  <meta property="og:title" content="Seeding Images From Unsplash">
<meta property="og:description" content="Get beautiful images seed data with zero effort.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.klimo.io/posts/unsplash-seeds/">
<meta property="og:image:width" content="2048" />
<meta property="og:image:height" content="1170" />


  
  

  
  
  
  

  
  
  <meta property="og:image" content="https://og-image.janklimo.now.sh/Seeding%20Images%20From%20Unsplash?tags=Ruby,Ruby%20on%20Rails&date=September%2030,%202019&time=3">
  <meta name="twitter:image" content="https://og-image.janklimo.now.sh/Seeding%20Images%20From%20Unsplash?tags=Ruby,Ruby%20on%20Rails&date=September%2030,%202019&time=3">


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@janklimo">
<meta name="twitter:creator" content="@janklimo">
<meta name="twitter:title" content="Seeding Images From Unsplash">
<meta name="twitter:description" content="Get beautiful images seed data with zero effort.">

  <link rel="stylesheet" href=/styles.css>
  <link href="maxcdn.bootstrapcdn.com" rel="preconnect" crossorigin>
  <link href="fonts.googleapis.com" rel="preconnect" crossorigin>
  <link href="www.googletagmanager.com" rel="preconnect" crossorigin>
  <link href="//fonts.googleapis.com/css?family=PT+Sans:400,600,700,900" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  
  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134476453-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-134476453-1');
  </script>
</head>

    <body>
        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        <h1 class="site-title">
                            <a title="Klimo.io" href="/">Klimo.io</a>
                        </h1>
                    </div>
                    <ul class="site-nav">
                        

  
  
  
  
  <li class="site-nav-item">
    <a title="Blog" href="/"
      class="active">Blog</a>
  </li>

  
  
  
  
  <li class="site-nav-item">
    <a title="Shopify Apps" href="/shopify-apps/"
      class="">Shopify Apps</a>
  </li>


                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Seeding Images From Unsplash</h1>
    <p class="post-date post-line">
        <span><time datetime="2019-09-30" itemprop="datePublished">September 30, 2019</time></span>
        
            <span> â€¢ 3 min read</span>
        
    </p>
</header>


        <div class="post-content clearfix">
    

    

<p>Recently we&rsquo;ve been making a more conscious effort to improve the quality of our seed data.</p>

<p>Firstly, to make it easier to onboard new team members. Secondly, to make the app ready for
<a href="https://devcenter.heroku.com/articles/github-integration-review-apps" target="_blank">Review Apps</a>. Certainly,
it&rsquo;s a great thing to be able to just re-seed your database if your local experiments go awry ðŸ˜…</p>

<p>The kind of seeds I&rsquo;ve seen over the years typically neglect images. They either use a minimal
placeholder, use a few nicer images that are repeated over and over and checked into source
control, or don&rsquo;t do anything at all. How can we get this kind of awesomeness with almost
no effort?</p>

<p><img src="/posts/unsplash-seeds/seeds.png" alt="Seeded images" /></p>

<p>Enter&hellip;</p>

<h3 id="unsplash">Unsplash</h3>

<p><a href="https://unsplash.com/" target="_blank">Unsplash</a> is <em>the internet&rsquo;s source of freely useable images</em>. It comes
with a simple API we can use to seed our images from. Here&rsquo;s how:</p>

<p><a href="https://unsplash.com/developers" target="_blank">Sign up and create your app</a> to get your API credentials.</p>

<p>Install the gem:</p>

<pre><code class="language-ruby"># API for seeding free, high-definition photos
gem 'unsplash'
</code></pre>

<p>Initialize it (e.g. <code>config/initializers/unsplash.rb</code>):</p>

<pre><code class="language-ruby">Unsplash.configure do |config|
  config.application_access_key = ENV['UNSPLASH_ACCESS_KEY']
  config.application_secret = ENV['UNSPLASH_SECRET_KEY']
  config.utm_source = 'your_app_name'
end
</code></pre>

<p>With that set up, you can fetch a collection of images with a single command:</p>

<pre><code class="language-ruby">unsplash_images = Unsplash::Photo.search('architecture', 1, 25)
</code></pre>

<p>This tells Unsplash to return page 1 of the results and use 25 records per page.</p>

<p>We use <a href="https://github.com/shrinerb/shrine/" target="_blank">Shrine</a> which makes it easy to use a remote URL
as a source of attachment. To accomplish that, add the following to your attacher:</p>

<pre><code class="language-ruby">plugin :infer_extension # Unsplash image URLs don't come with an extension
plugin :remote_url, max_size: 20.megabytes # or your custom limit
</code></pre>

<p>Here&rsquo;s the final implementation used to seed data:</p>

<pre><code class="language-ruby">module Seeds
  module Images
    def self.seed(property:)
      p 'Seeding property images...'

      # Add more than 20 items to test pagination.
      unsplash_images = Unsplash::Photo.search('architecture', 1, 25)

      unsplash_images.each do |unsplash_image|
        image = Properties::Image.create!(
          property: property,
          category: Properties::Image.categories.keys.sample,
          taken_on: rand(5..200).days.ago,
          title: unsplash_image.description,
          file_remote_url: unsplash_image.urls.regular
        )
        Properties::Images::Publisher.(image)
      end

      p 'Done seeding images! ðŸŽ‰'
    rescue Unsplash::UnauthorizedError
      p 'Unsplash API keys not found, no images will be seeded.'
    end
  end
end
</code></pre>

<p>Rescuing from <code>Unsplash::UnauthorizedError</code> gives us the flexibility to make this an opt-in
feature available if you set up your Unsplash ENV variables.</p>

<p>Careful observer will notice that this is not your typical structure of <code>seeds.rb</code>. In an
effort to make our seeds more maintainable, we&rsquo;ve broken it down into modules.</p>

<p>Every module has a single responsibility for seeding just one type of records.
We keep these under <code>db/seeds/*.rb</code>.</p>

<p>This allows for a wonderfully clean <code>seeds.rb</code> file ðŸŽ‰</p>

<pre><code class="language-ruby">Dir[Rails.root.join('db', 'seeds', '*.rb')].each { |f| require f }

ApplicationRecord.transaction do
  property = Property.create(name: 'Empire State Building')
  Seeds::Images.seed(property: property)
  # Seeds::Tenants.seed(property: property)
  # Seeds::Files.seed(property: property)
  # etc.
end
</code></pre>

<p>Eager to learn about your experience with making seeds more useful!</p>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/ruby/">Ruby</a>, 
            
                <a href="/tags/ruby-on-rails/">Ruby on Rails</a>
            
        </p>
    

    <div class="share">
        
        <a class="icon-twitter" href="https://twitter.com/share?text=Seeding%20Images%20From%20Unsplash by @janklimo&hashtags=Ruby%2c%20Ruby%20on%20Rails&url=https%3a%2f%2fwww.klimo.io%2fposts%2funsplash-seeds%2f"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
    </div>

    
<div id="mc_embed_signup">
    <form action="https://klimo.us2.list-manage.com/subscribe/post?u=60a38ce5acde10117dd351c1c&amp;id=89ad965331" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" rel="noopener" novalidate>
        <div id="mc_embed_signup_scroll">
            <label for="mce-EMAIL">Subscribe to get my latest content by email</label>
            <p class="intro">Let me notify you when I publish a new post (once or twice a month).</p>
            <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
            
            <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_60a38ce5acde10117dd351c1c_89ad965331" tabindex="-1" value=""></div>
            <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
        </div>
    </form>
</div>


</footer>
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Klimo.io" href="/">Klimo.io</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>
                <div class="social-icons">
    
        <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/janklimo" target="_blank" rel="noopener">
            <i class="fa fa-twitter"></i>
        </a>
    
    
        <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/janklimo" target="_blank" rel="noopener">
            <i class="fa fa-github-alt"></i>
        </a>
    
    
        <a class="button-square button-social hint--top" data-hint="Stack Overflow" title="Stack Overflow" href="https://stackoverflow.com/users/3678689/jan-klimo" target="_blank" rel="noopener">
            <i class="fa fa-stack-overflow"></i>
        </a>
    
    
        <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://www.linkedin.com/in/janklimo/" target="_blank" rel="noopener">
            <i class="fa fa-linkedin"></i>
        </a>
    
    <a class="button-square" target="_blank" href="/index.xml"><i class="fa fa-rss"></i></a>
</div>

            </div>
        </footer>

        <script src=/bundle.js></script>
    </body>
</html>

